{% extends 'home/tes.html' %}
{% block content %}
 


    <!-- Card untuk header dan konten -->
    <div class="card shadow-sm">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h1 class="h3 mb-0">Score Summary for {{ course.course_name }}</h1>
        <a href="{% url 'learner:score_summary_detail' course_id=course.id %}?download=csv" class="btn btn-outline-light btn-sm">
          <i class="bi bi-download me-2"></i>Export to CSV
        </a>
      </div>
      <div class="card-body">
        {% if user_scores %}
          <!-- Loop untuk setiap peserta -->
          {% for user_score in user_scores %}
            <!-- Header untuk setiap peserta -->
            <div class="mt-4 mb-3">
              <h5 class="fw-bold text-primary">
                <i class="bi bi-person-circle me-2"></i>{{ user_score.user.username }}
              </h5>
              <hr class="border-primary border-2">
            </div>
            <!-- Tabel responsif untuk asesmen peserta -->
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle {% cycle 'table-light' 'table-secondary' as row_colors %}">
                <thead class="table-dark">
                  <tr>
                    <th scope="col">Assessment</th>
                    <th scope="col">Score</th>
                    <th scope="col">Max Score</th>
                    <th scope="col">Overall %</th>
                    <th scope="col">Status</th>
                    <th scope="col">Grade</th>
                  </tr>
                </thead>
                <tbody>
                  {% for result in user_score.assessment_results %}
                    <tr>
                      <td>{{ result.name }}</td>
                      <td>{{ result.score|floatformat:2 }}</td>
                      <td>{{ result.max_score }}</td>
                      {% if forloop.last %}
                        <td>{{ user_score.overall_percentage }}%</td>
                        <td>
                          <span class="badge {% if user_score.status == 'Pass' %}bg-success{% else %}bg-danger{% endif %}">
                            {{ user_score.status }}
                          </span>
                        </td>
                        <td>{{ user_score.grade }}</td>
                      {% else %}
                        <td></td>
                        <td></td>
                        <td></td>
                      {% endif %}
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% empty %}
            <div class="alert alert-info text-center" role="alert">
              <i class="bi bi-info-circle me-2"></i>
              No participants enrolled in this course.
            </div>
          {% endfor %}
        {% else %}
          <div class="alert alert-info text-center" role="alert">
            <i class="bi bi-info-circle me-2"></i>
            No participants enrolled in this course.
          </div>
        {% endif %}
      </div>
    </div>



{% endblock %}