<!-- partner/analytics.html -->
{% extends 'home/tes.html' %}
{% load custom_filters %}
{% block content %}
<div class="max-w-7xl mx-auto p-6">
  <h2 class="text-xl font-semibold mb-4">Partner Analytics</h2>
    <a href="{% url 'partner:heatmap' %}" class="btn btn-primary mb-4">User Activity Heatmap</a>
  <!-- Stat Boxes Compact -->
  <div class="row mb-4">
    <div class="col-sm-6 col-lg-6 mb-3 mb-sm-0">
      <div class="card text-center border-0 shadow-sm h-100">
        <div class="card-body py-3">
          <h6 class="text-muted mb-1">ðŸ‘€ Weekly Views</h6>
          <h3 class="fw-bold text-primary mb-0">{{ weekly_views }}</h3>
        </div>
      </div>
    </div>
    <div class="col-sm-6 col-lg-6">
      <div class="card text-center border-0 shadow-sm h-100">
        <div class="card-body py-3">
          <h6 class="text-muted mb-1">ðŸ“… Monthly Views</h6>
          <h3 class="fw-bold text-success mb-0">{{ monthly_views }}</h3>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-white p-4 rounded-lg shadow mb-6">
    <h3 class="text-lg font-medium mb-2">Views per Course</h3>
    <canvas id="viewChart" height="100"></canvas>
  </div>

  <div class="bg-white p-4 rounded-lg shadow">
    <h3 class="text-lg font-medium mb-2">Comments per Course</h3>
    <canvas id="commentChart" height="100"></canvas>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const viewChart = document.getElementById('viewChart');
new Chart(viewChart, {
    type: 'bar',
    data: {
        labels: {{ view_by_course|pluck:"course__course_name"|safe }},
        datasets: [{
            label: 'Total Views',
            data: {{ view_by_course|pluck:"total"|safe }},
            backgroundColor: '#60a5fa',
        }]
    },
    options: { responsive: true }
});

const commentChart = document.getElementById('commentChart');
new Chart(commentChart, {
    type: 'bar',
    data: {
        labels: {{ comment_by_course|pluck:"course__course_name"|safe }},
        datasets: [{
            label: 'Total Comments',
            data: {{ comment_by_course|pluck:"total"|safe }},
            backgroundColor: '#34d399',
        }]
    },
    options: { responsive: true }
});
</script>
{% endblock %}
