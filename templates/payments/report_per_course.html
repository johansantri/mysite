{% extends 'home/tes.html' %}
{% load humanize %}

{% block content %}
<div class="my-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold text-primary mb-0">ðŸ“Š Laporan Pembayaran per Course</h2>
    <span class="badge bg-info text-dark px-3 py-2 shadow-sm">
      Total Course: {{ report|length }}
    </span>
  </div>

  <!-- Table Wrapper -->
  <div class="card border-0 shadow-sm">
    <div class="card-body p-0">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-primary text-white">
          <tr>
            <th class="text-center" style="width: 50px;">No</th>
            <th>Nama Course</th>
            <th class="text-center">Jumlah Transaksi</th>
            <th class="text-end">Total Pembayaran (Rp)</th>
            <th class="text-end">Total Voucher (Rp)</th>
            <th class="text-end">Partner Earning (Rp)</th>
            <th class="text-end">ICE Earning (Rp)</th>
            <th class="text-end">Platform Fee (Rp)</th>
          </tr>
        </thead>
        <tbody>
          {% for item in report %}
          <tr>
            <td class="text-center fw-semibold text-muted">{{ forloop.counter }}</td>
            <td>
              <a href="{% url 'payments:report_per_course_detail' item.course__id %}"
                 class="text-decoration-none fw-semibold text-dark">
                {{ item.course__course_name }}
              </a>
            </td>
            <td class="text-center fw-bold">{{ item.total_transaksi }}</td>
            <td class="text-end text-success fw-semibold">
              Rp{{ item.total_amount|floatformat:0|intcomma }}
            </td>
            <td class="text-end text-danger fw-semibold">
              Rp{{ item.total_voucher|floatformat:0|intcomma }}
            </td>
            <td class="text-end text-info fw-semibold">
              Rp{{ item.total_partner|floatformat:0|intcomma }}
            </td>
            <td class="text-end text-primary fw-semibold">
              Rp{{ item.total_ice|floatformat:0|intcomma }}
            </td>
            <td class="text-end text-warning fw-semibold">
              Rp{{ item.total_platform_fee|floatformat:0|intcomma }}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="8" class="text-center text-muted py-4">
              Belum ada transaksi <span class="fw-semibold">completed</span>.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Footer Summary (optional) -->
    {% if report %}
    <div class="alert alert-light border mt-4 shadow-sm">
    <div class="d-flex justify-content-between">
        <div class="fw-bold text-secondary">Total Semua Course:</div>
        <div class="text-end">
        <div><strong>Total Pembayaran:</strong> Rp{{ summary.total_amount|floatformat:0|intcomma }}</div>
        <div><strong>Total Voucher:</strong> Rp{{ summary.total_voucher|floatformat:0|intcomma }}</div>

        </div>
    </div>
    </div>
    {% endif %}


</div>
{% endblock %}
